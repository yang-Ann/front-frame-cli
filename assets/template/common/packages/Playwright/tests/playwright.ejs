import { chromium, devices } from "@playwright/test";
#BR#
// https://playwright.dev/docs/library
#BR#
(async () => {
  #BR#
  const browser = await chromium.launch({
    headless: false, // 关闭无头模板
    slowMo: 100, // 操作放慢 100 ms
  });
  #BR#
  // 上下文
  const context = await browser.newContext();
  // 指定设备
  // const context = await browser.newContext(devices["iPhone 13 landscape"]);
  #BR#
  // 新窗口
  const page = await context.newPage();
  #BR#
  // 拦截网络请求
  await page.route('**/*', route => {
    const resType = route.request().resourceType();
    // 图片则中断请求
    return resType === "image" ? route.abort() : route.continue();
  });
  #BR#
  // 打开 url 地址
  await page.goto("https://www.baidu.com/", {
    waitUntil: "networkidle" // 网络空闲时
  });
  #BR#
  // 点击指定选择器元素
  await page.locator("#kw").click();
  #BR#
  // 填充字符串到指定元素
  await page.locator("#kw").fill("hello world");
  #BR#
  // 点击指定规则的元素
  await page.getByRole("button", { name: "百度一下" }).click();
  #BR#
  // 等待 1000
  await page.waitForTimeout(1000);
  #BR#
  // 截取屏幕
  await page.screenshot({ 
    path: `${Date.now()}.png`, // 路径
    fullPage: true // 截取全部内容
  });
  // 截取元素
  await page.locator("#su").screenshot({ path: "百度一下_button.png" });
  #BR#
  // 释放资源
  await context.close();
  await browser.close();
})();